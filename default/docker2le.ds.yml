apiVersion: extensions/v1beta1
kind: DaemonSet
metadata:
  labels:
    app: docker2le
  name: docker2le
spec:
  template:
    metadata:
      labels:
        app: docker2le
      name: docker2le
    spec:
      containers:
      - env:
        - name: DOCKER_LE_CONFIG 
          value: |
            {"default":{"labels":["io.kubernetes.pod.namespace","io.kubernetes.pod.name","io.kubernetes.container.name"],"token":"e3e58a10-f13b-4482-864a-385e320f87f2"},"filters":[{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=default"],"token":"d0943933-a55b-4f78-aecc-738dac439722"},{"labels":["io.kubernetes.pod.name","io.kubernetes.container.name"],"filter":["io.kubernetes.pod.namespace=kube-system"],"token":"39056d37-d984-4bb9-923c-56afe9a934d3"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=prod","io.kubernetes.container.name=api-gateway"],"token":"4125f4b4-5578-48bb-920e-4e165b30a644"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=prod","io.kubernetes.container.name=api-gateway-tyk"],"token":"2161cfbd-f125-4dac-a863-745bea08170d"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=prod","io.kubernetes.container.name=api-gateway-tyk-redis"],"token":"556e13aa-67f9-45b9-8a1f-35c82e93d53c"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=prod","io.kubernetes.container.name=import"],"token":"7e7ab4ce-f475-4749-87a6-f9c552f146fe"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=prod","io.kubernetes.container.name=import-activemq-master"],"token":"625194b4-9f0c-45e1-b8ad-b7be1c7a921c"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=prod","io.kubernetes.container.name=legacy-translator-allocation"],"token":"032d17ea-e78f-417d-ade6-8329147821c1"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=prod","io.kubernetes.container.name=parser-qa"],"token":"0070bc5f-48c9-40ee-8cd8-1779beda263b"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=prod","io.kubernetes.container.name=project-permit"],"token":"db17049f-aeb1-49e8-aade-2ddfcf310fe0"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=api-gateway"],"token":"6fb20b87-45c8-4da1-9f3c-5e2f99683259"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=api-gateway-tyk"],"token":"6b3712cd-d5e9-467e-85b9-4c420e6668da"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=api-gateway-tyk-redis"],"token":"96933e80-116e-4731-b1f8-3bbef0a2706c"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=appstore-integration"],"token":"c68d4bd3-fbc6-4ef1-94be-4e6ca865ca45"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=client"],"token":"e9567137-3c60-47dd-9fd8-fb73731f8a4e"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=client-web-portal"],"token":"95d36e1b-927b-4513-9b0f-9120162b672d"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=communication"],"token":"64418aa4-5f73-44e5-afc6-c21164f2324e"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=file-management"],"token":"2433bc11-5d31-46a7-8a2c-72c15e26d997"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=itunes-appstore-project"],"token":"8a091f8a-48ff-477d-af7e-5c799d556ccc"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=itunes-translation"],"token":"08334fb9-fac6-4e32-ac0f-6608d6dfa182"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=legacy-translator-allocation"],"token":"8790317a-10b4-4562-9311-e228d5ada680"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=parser-qa"],"token":"449b85fe-178b-47f5-a77f-351ebba0372f"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=payment"],"token":"449b85fe-178b-47f5-a77f-351ebba0372f"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=project-permit"],"token":"4bbafe20-3340-4e93-961e-ac77f183a34c"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=realtime-communication"],"token":"f289ba9b-7a52-4977-89ab-b7488916db74"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=stag","io.kubernetes.container.name=tu-management"],"token":"0e6c1087-1fcc-4e4a-9c34-eaf43b3eb0da"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=api-gateway"],"token":"864ed427-4514-4d57-9d56-0545c56bb0d8"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=api-gateway-tyk"],"token":"89aa8a5d-a46b-43a3-9c71-c5d5377133c2"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=api-gateway-tyk-redis"],"token":"b0b3d121-e72e-44ba-a55c-eb6c00bd4540"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=appstore-integration"],"token":"3f31aac4-e7ea-4cd9-b20c-a821a709090d"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=client"],"token":"15b59cf6-8b7e-45eb-8d5e-edd0797bd5cc"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=client-web-portal"],"token":"7cc9edb7-3e3b-40da-832e-132f71d129c9"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=communication"],"token":"5ae376fc-bd7d-4d3c-901f-5f1ac3eb63ea"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=file-management"],"token":"deb69384-6a24-4ca6-b87c-a46b49793e03"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=itunes-appstore-project"],"token":"8cfe1c36-42cd-43d4-8dca-5f93152933a5"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=itunes-translation"],"token":"6e69f858-9ee7-4485-998f-061221920ff2"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=legacy-translator-allocation"],"token":"ff29c84d-b944-4c80-b343-4fcc3a5da422"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=parser-qa"],"token":"7a04a52a-62f2-427f-a123-78270b458771"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=payment"],"token":"2202cde4-4663-41ec-9434-d782b5c18122"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=project-permit"],"token":"727854a5-706b-4e44-9fb3-04e39bfc3d58"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=realtime-communication"],"token":"ad810283-9b6e-4731-bc2d-e9e34e08ca52"},{"labels":["io.kubernetes.pod.name"],"filter":["io.kubernetes.pod.namespace=dev","io.kubernetes.container.name=tu-management"],"token":"14a34d51-a3f2-419e-94a4-29812dae5e0d"}]}

        image: quay.io/onesky/docker2le:0.1.2
        name: docker2le
        resources:
          requests:
            cpu: 10m
            memory: 32Mi
          limits:
            cpu: 100m
            memory: 64Mi
        volumeMounts:
        - mountPath: /var/run/docker.sock
          name: dockerapi
      imagePullSecrets:
      - name: quay
      volumes:
      - name: dockerapi
        hostPath:
          path: /var/run/docker.sock

